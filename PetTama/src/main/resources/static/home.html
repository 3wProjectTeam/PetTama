<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PetTama - ë°˜ë ¤ë™ë¬¼ ê°€ìƒ ëŒë´„ ì„œë¹„ìŠ¤</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  <style>
    /* í™ˆí˜ì´ì§€ íŠ¹í™” ìŠ¤íƒ€ì¼ */
    .home-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .hero-section {
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-color) 100%);
      border-radius: var(--radius-lg);
      padding: 3rem 2rem;
      margin-bottom: 3rem;
      text-align: center;
      color: white;
      box-shadow: var(--shadow-md);
    }

    .hero-title {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 1rem;
    }

    .hero-subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      max-width: 800px;
      margin: 0 auto 2rem;
    }

    .hero-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .hero-btn {
      background-color: var(--primary-dark);
      color: white;
      font-weight: 700;
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius-md);
      text-decoration: none;
      transition: background-color var(--transition-fast), box-shadow var(--transition-fast);
      border: 2px solid var(--primary-dark);
    }

    .hero-btn:hover {
      background-color: var(--primary-color);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }


    .services-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 2rem;
      margin-bottom: 3rem;
    }

    .service-card {
      background-color: var(--background-light);
      border-radius: var(--radius-md);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast);
      text-decoration: none;
      color: var(--text-primary);
      display: flex;
      flex-direction: column;
    }

    .service-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-md);
    }

    .service-image {
      height: 160px;
      background-color: var(--primary-light);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
    }

    .service-content {
      padding: 1.5rem;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .service-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
      color: var(--text-primary);
    }

    .service-description {
      color: var(--text-secondary);
      margin-bottom: 1.25rem;
      line-height: 1.6;
      flex-grow: 1;
    }

    .service-link {
      align-self: flex-start;
      padding: 0.5rem 1rem;
      background-color: var(--primary-light);
      color: var(--primary-color);
      font-weight: 600;
      border-radius: var(--radius-sm);
      transition: background-color var(--transition-fast);
    }

    .service-link:hover {
      background-color: var(--primary-color);
      color: white;
    }

    .features-section {
      background-color: var(--background-light);
      border-radius: var(--radius-md);
      padding: 2rem;
      margin-bottom: 3rem;
      box-shadow: var(--shadow-sm);
    }

    .section-title {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      text-align: center;
      color: var(--text-primary);
    }

    .features-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .feature-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 1rem;
    }

    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
    }

    .feature-title {
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }

    .feature-description {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .quick-links {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 3rem;
    }

    .quick-link-card {
      flex: 1;
      min-width: 180px;
      background-color: var(--background-light);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      text-align: center;
      box-shadow: var(--shadow-sm);
      text-decoration: none;
      color: var(--text-primary);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .quick-link-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }

    .quick-link-icon {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
    }

    .quick-link-title {
      font-weight: 700;
      font-size: 1.1rem;
    }

    .welcome-message {
      background-color: var(--secondary-light);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-sm);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .welcome-icon {
      font-size: 2.5rem;
      color: var(--secondary-color);
    }

    .welcome-text {
      flex-grow: 1;
    }

    .welcome-title {
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }

    .welcome-description {
      color: var(--text-secondary);
    }

    .status-overview {
      background-color: var(--background-light);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-sm);
    }

    .status-title {
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .status-icon {
      color: var(--primary-color);
    }

    .status-content {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .status-card {
      flex: 1;
      min-width: 150px;
      background-color: var(--background-gray);
      border-radius: var(--radius-sm);
      padding: 1rem;
      text-align: center;
    }

    .status-number {
      font-size: 1.75rem;
      font-weight: 800;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }

    .status-label {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .login-required {
      text-align: center;
      padding: 2rem;
      background-color: var(--primary-light);
      border-radius: var(--radius-md);
      margin: 2rem 0;
    }

    .login-required-title {
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--primary-dark);
    }

    .user-greeting {
      font-weight: 600;
      margin-right: 1rem;
    }

    @media (max-width: 768px) {
      .hero-title {
        font-size: 1.75rem;
      }

      .hero-subtitle {
        font-size: 1rem;
      }

      .services-grid {
        grid-template-columns: 1fr;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }

      .quick-links {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
<div class="home-container">
  <header>
    <h1>PetTama</h1>
    <p class="subtitle">ë‹¹ì‹ ë§Œì˜ ê°€ìƒ ë°˜ë ¤ë™ë¬¼ì„ í‚¤ì›Œë³´ì„¸ìš”!</p>
  </header>

  <!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ì í™˜ì˜ ë©”ì‹œì§€ -->
  <div id="welcomeMessage" class="welcome-message" style="display: none;">
    <div class="welcome-icon">ğŸ‘‹</div>
    <div class="welcome-text">
      <h3 class="welcome-title"><span id="userNickname">ì‚¬ìš©ì</span>ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!</h3>
      <p class="welcome-description">ì˜¤ëŠ˜ë„ ë‹¹ì‹ ì˜ ê°€ìƒ ë°˜ë ¤ë™ë¬¼ê³¼ ì¦ê±°ìš´ ì‹œê°„ì„ ë³´ë‚´ì„¸ìš”.</p>
    </div>
  </div>

  <!-- ë©”ì¸ ì˜ì›… ì„¹ì…˜ -->
  <section class="hero-section">
    <h1 class="hero-title">ë‹¹ì‹ ë§Œì˜ ê°€ìƒ ë°˜ë ¤ë™ë¬¼ì„ ë§Œë‚˜ë³´ì„¸ìš”</h1>
    <p class="hero-subtitle">PetTamaëŠ” í˜„ì‹¤ì ì¸ ë°˜ë ¤ë™ë¬¼ ëŒë´„ ê²½í—˜ì„ ì œê³µí•˜ëŠ” ê°€ìƒ ë°˜ë ¤ë™ë¬¼ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì¼ìƒ ì†ì—ì„œ íŠ¹ë³„í•œ ì¹œêµ¬ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”!</p>
    <div class="hero-buttons">
      <a href="/auth/register" class="hero-btn" id="heroRegisterBtn">ì§€ê¸ˆ ì‹œì‘í•˜ê¸°</a>
      <a href="#services" class="hero-btn">ì„œë¹„ìŠ¤ ì‚´í´ë³´ê¸°</a>
    </div>
  </section>

  <!-- ì‚¬ìš©ì ìƒíƒœ ê°œìš” (ë¡œê·¸ì¸í•œ ê²½ìš°ë§Œ í‘œì‹œ) -->
  <div id="userStatusOverview" class="status-overview" style="display: none;">
    <h3 class="status-title"><span class="status-icon">ğŸ“Š</span> ë‚˜ì˜ í™œë™ ê°œìš”</h3>
    <div class="status-content">
      <div class="status-card">
        <div class="status-number" id="petCount">0</div>
        <div class="status-label">ë°˜ë ¤ë™ë¬¼</div>
      </div>
      <div class="status-card">
        <div class="status-number" id="postCount">0</div>
        <div class="status-label">ì‘ì„± ê²Œì‹œê¸€</div>
      </div>
      <div class="status-card">
        <div class="status-number" id="itemCount">0</div>
        <div class="status-label">ë³´ìœ  ì•„ì´í…œ</div>
      </div>
    </div>
  </div>

  <!-- ë¡œê·¸ì¸ í•„ìš” ë©”ì‹œì§€ (ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš°ë§Œ í‘œì‹œ) -->
  <div id="loginRequired" class="login-required">
    <h3 class="login-required-title">ë” ë§ì€ ê¸°ëŠ¥ì„ ì´ìš©í•˜ë ¤ë©´ ë¡œê·¸ì¸í•˜ì„¸ìš”</h3>
    <p>ë‚˜ë§Œì˜ ë°˜ë ¤ë™ë¬¼ì„ ë§Œë“¤ê³ , ê´€ë¦¬í•˜ê³ , ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ê³¼ ì†Œí†µí•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
    <div class="hero-buttons" style="margin-top: 1rem;">
      <a href="/auth/login" class="hero-btn">ë¡œê·¸ì¸</a>
      <a href="/auth/register" class="hero-btn">íšŒì›ê°€ì…</a>
    </div>
  </div>

  <!-- ì„œë¹„ìŠ¤ ì¹´ë“œ ì„¹ì…˜ -->
  <section id="services">
    <h2 class="section-title">PetTama ì„œë¹„ìŠ¤</h2>
    <div class="services-grid">
      <a href="/home" class="service-card">
        <div class="service-image">ğŸ </div>
        <div class="service-content">
          <h3 class="service-title">ë‚´ ë°˜ë ¤ë™ë¬¼</h3>
          <p class="service-description">ë‹¹ì‹ ë§Œì˜ ê°€ìƒ ë°˜ë ¤ë™ë¬¼ì„ ë§Œë“¤ê³  ê´€ë¦¬í•˜ì„¸ìš”. ë¨¹ì´ ì£¼ê¸°, ë†€ì•„ì£¼ê¸°, ëª©ìš•ì‹œí‚¤ê¸° ë“± ë‹¤ì–‘í•œ ìƒí˜¸ì‘ìš©ì„ í†µí•´ ë°˜ë ¤ë™ë¬¼ê³¼ ìœ ëŒ€ê°ì„ ìŒ“ì•„ë³´ì„¸ìš”.</p>
          <span class="service-link">ì‹œì‘í•˜ê¸°</span>
        </div>
      </a>

      <a href="/shop" class="service-card">
        <div class="service-image">ğŸ›’</div>
        <div class="service-content">
          <h3 class="service-title">ìƒì </h3>
          <p class="service-description">ë°˜ë ¤ë™ë¬¼ì„ ìœ„í•œ ë‹¤ì–‘í•œ ì•„ì´í…œì„ êµ¬ë§¤í•˜ì„¸ìš”. ì¥ë‚œê°, ë¨¹ì´, ì•¡ì„¸ì„œë¦¬ ë“± ë‹¤ì–‘í•œ ìƒí’ˆì´ ì¤€ë¹„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
          <span class="service-link">ì‡¼í•‘í•˜ê¸°</span>
        </div>
      </a>

      <a href="/board" class="service-card">
        <div class="service-image">ğŸ“</div>
        <div class="service-content">
          <h3 class="service-title">ì»¤ë®¤ë‹ˆí‹°</h3>
          <p class="service-description">ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ê³¼ ì •ë³´ë¥¼ ê³µìœ í•˜ê³  ì†Œí†µí•˜ì„¸ìš”. ê²Œì‹œíŒì„ í†µí•´ ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬ íŒì´ë‚˜ ì¬ë¯¸ìˆëŠ” ê²½í—˜ì„ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
          <span class="service-link">ì°¸ì—¬í•˜ê¸°</span>
        </div>
      </a>
    </div>
  </section>

  <!-- íŠ¹ì§• ì„¹ì…˜ -->
  <section class="features-section">
    <h2 class="section-title">PetTama íŠ¹ì§•</h2>
    <div class="features-list">
      <div class="feature-item">
        <div class="feature-icon">ğŸ®</div>
        <h3 class="feature-title">ì‹¤ì‹œê°„ ìƒí˜¸ì‘ìš©</h3>
        <p class="feature-description">ë‹¤ì–‘í•œ í™œë™ì„ í†µí•´ ë°˜ë ¤ë™ë¬¼ê³¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒí˜¸ì‘ìš©í•˜ì„¸ìš”.</p>
      </div>

      <div class="feature-item">
        <div class="feature-icon">ğŸ§¬</div>
        <h3 class="feature-title">í˜„ì‹¤ì ì¸ ì„±ì¥ ì‹œìŠ¤í…œ</h3>
        <p class="feature-description">ë‹¹ì‹ ì˜ ê´€ë¦¬ì— ë”°ë¼ ë°˜ë ¤ë™ë¬¼ì˜ ìƒíƒœì™€ ì„±ê²©ì´ ë³€í™”í•©ë‹ˆë‹¤.</p>
      </div>

      <div class="feature-item">
        <div class="feature-icon">ğŸ’</div>
        <h3 class="feature-title">ì •ì„œì  ìœ ëŒ€ê°</h3>
        <p class="feature-description">ì§€ì†ì ì¸ ê´€ë¦¬ë¥¼ í†µí•´ ë°˜ë ¤ë™ë¬¼ê³¼ íŠ¹ë³„í•œ ìœ ëŒ€ê°ì„ í˜•ì„±í•˜ì„¸ìš”.</p>
      </div>

      <div class="feature-item">
        <div class="feature-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
        <h3 class="feature-title">í™œë°œí•œ ì»¤ë®¤ë‹ˆí‹°</h3>
        <p class="feature-description">ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ê³¼ ê²½í—˜ì„ ê³µìœ í•˜ê³  í•¨ê»˜ ì„±ì¥í•˜ì„¸ìš”.</p>
      </div>
    </div>
  </section>

  <!-- ë¹ ë¥¸ ë§í¬ ì„¹ì…˜ -->
  <section>
    <h2 class="section-title">ë¹ ë¥¸ ë§í¬</h2>
    <div class="quick-links">
      <a href="/home?userId=1" class="quick-link-card" id="myPetsLink">
        <div class="quick-link-icon">ğŸ¾</div>
        <div class="quick-link-title">ë‚´ ë°˜ë ¤ë™ë¬¼</div>
      </a>

      <a href="/shop" class="quick-link-card">
        <div class="quick-link-icon">ğŸ›ï¸</div>
        <div class="quick-link-title">ìƒì  ë°©ë¬¸</div>
      </a>

      <a href="/board" class="quick-link-card">
        <div class="quick-link-icon">ğŸ“‹</div>
        <div class="quick-link-title">ê²Œì‹œíŒ</div>
      </a>

      <a href="/users/1" class="quick-link-card" id="myProfileLink">
        <div class="quick-link-icon">ğŸ‘¤</div>
        <div class="quick-link-title">ë‚´ í”„ë¡œí•„</div>
      </a>
    </div>
  </section>

  <footer>
    <p>&copy; 2025 PetTama - ê°€ìƒ ë°˜ë ¤ë™ë¬¼ ì„œë¹„ìŠ¤</p>
  </footer>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // DOM ìš”ì†Œ
    const authButtons = document.getElementById('authButtons');
    const welcomeMessage = document.getElementById('welcomeMessage');
    const userNickname = document.getElementById('userNickname');
    const userStatusOverview = document.getElementById('userStatusOverview');
    const loginRequired = document.getElementById('loginRequired');
    const heroRegisterBtn = document.getElementById('heroRegisterBtn');
    const myPetsLink = document.getElementById('myPetsLink');
    const myProfileLink = document.getElementById('myProfileLink');

    // ìƒíƒœ ë³€ìˆ˜
    let isLoggedIn = false;
    let currentUser = null;

    // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
    checkAuthStatus();

    // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
    async function checkAuthStatus() {
      try {
        const response = await fetch('/api/auth/user');

        if (response.ok) {
          // ë¡œê·¸ì¸ëœ ìƒíƒœ
          currentUser = await response.json();
          isLoggedIn = true;

          // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
          userNickname.textContent = currentUser.nickname;

          // í™˜ì˜ ë©”ì‹œì§€ í‘œì‹œ
          welcomeMessage.style.display = 'flex';

          // ì‚¬ìš©ì ìƒíƒœ ê°œìš” í‘œì‹œ
          userStatusOverview.style.display = 'block';

          // ë¡œê·¸ì¸ í•„ìš” ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
          loginRequired.style.display = 'none';

          // ë§í¬ URL ì—…ë°ì´íŠ¸
          myPetsLink.href = `/home?userId=${currentUser.id}`;
          myProfileLink.href = `/users/${currentUser.id}`;

          // ì˜ì›… ì„¹ì…˜ ë²„íŠ¼ ë³€ê²½
          heroRegisterBtn.textContent = 'ë‚´ ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬í•˜ê¸°';
          heroRegisterBtn.href = `/home?userId=${currentUser.id}`;

          // ì¸ì¦ ë²„íŠ¼ ì—…ë°ì´íŠ¸
          authButtons.innerHTML = `
              <span class="user-greeting">ì•ˆë…•í•˜ì„¸ìš”, ${currentUser.nickname}ë‹˜!</span>
              <form id="logoutForm" action="/api/auth/logout" method="post" style="display:inline;">
                <button type="submit" class="navigation-button">ë¡œê·¸ì•„ì›ƒ</button>
              </form>
            `;

          // ì‚¬ìš©ì í†µê³„ ë¡œë“œ
          loadUserStats(currentUser.id);
        } else {
          // ë¡œê·¸ì¸ë˜ì§€ ì•Šì€ ìƒíƒœ
          isLoggedIn = false;

          // í™˜ì˜ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
          welcomeMessage.style.display = 'none';

          // ì‚¬ìš©ì ìƒíƒœ ê°œìš” ìˆ¨ê¸°ê¸°
          userStatusOverview.style.display = 'none';

          // ë¡œê·¸ì¸ í•„ìš” ë©”ì‹œì§€ í‘œì‹œ
          loginRequired.style.display = 'block';

          // ì¸ì¦ ë²„íŠ¼ ì—…ë°ì´íŠ¸
          authButtons.innerHTML = `
              <a href="/auth/login" class="navigation-button">ë¡œê·¸ì¸</a>
              <a href="/auth/register" class="navigation-button">íšŒì›ê°€ì…</a>
            `;
        }
      } catch (error) {
        console.error('Error checking auth status:', error);
        isLoggedIn = false;
      }
    }

    // ì‚¬ìš©ì í†µê³„ ë¡œë“œ
    async function loadUserStats(userId) {
      try {
        // í« ìˆ˜ ë¡œë“œ
        const petsResponse = await fetch(`/api/user-nums/${userId}`);
        if (petsResponse.ok) {
          const pets = await petsResponse.json();
          document.getElementById('petCount').textContent = pets.length;
        }

        // ê²Œì‹œê¸€ ìˆ˜ ë¡œë“œ (APIê°€ ìˆë‹¤ê³  ê°€ì •)
        try {
          const postsResponse = await fetch(`/api/posts/user/${userId}`);
          if (postsResponse.ok) {
            const posts = await postsResponse.json();
            document.getElementById('postCount').textContent = posts.length;
          }
        } catch (error) {
          // APIê°€ ì—†ì„ ê²½ìš° ê¸°ë³¸ê°’ ìœ ì§€
          document.getElementById('postCount').textContent = '?';
        }

        // ì•„ì´í…œ ìˆ˜ ë¡œë“œ
        try {
          const itemsResponse = await fetch(`/api/items/user/${userId}`);
          if (itemsResponse.ok) {
            const items = await itemsResponse.json();
            let totalItems = 0;
            items.forEach(item => {
              totalItems += item.quantity;
            });
            document.getElementById('itemCount').textContent = totalItems;
          }
        } catch (error) {
          // ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ê°’ ìœ ì§€
          document.getElementById('itemCount').textContent = '?';
        }
      } catch (error) {
        console.error('Error loading user stats:', error);
      }
    }
  });
</script>
</body>
</html>